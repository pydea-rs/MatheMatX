program midpoint_integral
    implicit none
    real::h, y0, yixi, integral_value
    integer::xf, xi, n, i
    real, dimension(:), allocatable::y,x
    y0 = 1 ! e ^ (-x^3) | x = 0 ===> y0 = e ^ 0 = 1
    h = 0.01
    xf = 1
    xi = 0
    n = (xf - xi) / h
    print *, "n is ", n
    print*,"------------------------------------------------------------------------------------------------------------"
    print*,"|[          i             ]     |     [              xi              ]", &
      "   |    {                yi          }|"
    print*,"------------------------------------------------------------------------------------------------------------"
    allocate(y(n + 1))
    allocate(x(n + 1))
    x(1) = h / 2
    y(1) = h * exp(-(x(1) ** 3)) 
    do i=1, n
        yixi = exp(-(x(i) ** 3))
        x(i + 1) = x(i) + h
        y(i + 1) = h * yixi
        print *, "[    i = ", i, "    ] ", &
        "  ===>    [    x = ", x(i), "    ] ===>", &
            "   {   y = ", y(i), "    }"
    enddo
    print*,"------------------------------------------------------------------------------------------------------------"
    print*,"------------------------------------------------------------------------------------------------------------"
    integral_value = 0
    do i=1, n+1
        integral_value = integral_value + y(i)
    enddo
    print*, "     ******** integral{ e^(-x^3) } in [0, 1] = ", integral_value, "    **********"
    print*,"------------------------------------------------------------------------------------------------------------"
    print*,"------------------------------------------------------------------------------------------------------------"

end